(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const x of s.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&a(x)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const $={easy:{gameTime:30,initialSpeed:1e3,fastSpeed:800,speedChangeTime:15,pointsPerHit:1,timeBonus:!1},medium:{gameTime:45,initialSpeed:700,fastSpeed:500,speedChangeTime:25,pointsPerHit:2,timeBonus:!0},hard:{gameTime:60,initialSpeed:500,fastSpeed:300,speedChangeTime:40,pointsPerHit:3,timeBonus:!0}};let H=-1;function _(e,r="easy",o=0){const a=$[r];let n=a.pointsPerHit;return a.timeBonus&&o<10&&(n+=1),e+n}function F(e,r=!0){let o;if(r&&H!==-1)do o=Math.floor(Math.random()*e);while(o===H);else o=Math.floor(Math.random()*e);return H=o,o}function z(){H=-1}function K(e="easy"){return $[e].gameTime}function X(e,r="easy"){const o=$[r];return e>=o.speedChangeTime?o.initialSpeed:o.fastSpeed}function Y(e,r="easy"){return e===$[r].speedChangeTime}let i,C,k,I,q,h,l,g,D,m,M,T,A;function j(){i=document.querySelectorAll(".square"),document.querySelector(".mole"),C=document.querySelector("#time-left"),k=document.querySelector("#score"),I=document.querySelector("#high-score"),q=document.querySelector("#final-score"),h=document.querySelector("#start-button"),l=document.querySelector("#pause-button"),g=document.querySelector("#restart-button"),D=document.querySelector("#reset-highscore-button"),m=document.querySelector("#high-score-message"),M=document.querySelectorAll(".difficulty-btn"),T=document.querySelector("#current-difficulty"),A=document.querySelector("#sr-announcer")}let y,d=0,b=0,f=30,S=null,w=null,E=!1,v=!1,u="easy",c=null;function t(e){console.log(e)}function J(){try{y=new Audio("audio/whack01.mp3"),y.addEventListener("error",()=>{console.warn("Audio file not found, game will work without sound"),y=null})}catch{console.warn("Audio initialization failed, game will work without sound"),y=null}}function N(){return parseInt(localStorage.getItem(`whackAMoleHighScore_${u}`))||0}function R(e){localStorage.setItem(`whackAMoleHighScore_${u}`,e),I&&(I.textContent=e)}function B(){t("updateHighScoreDisplay called");try{if(I){const e=N(u);I.textContent=e,t(`High score displayed: ${e}`)}else t("Error: highScore element not found")}catch(e){t(`Error in updateHighScoreDisplay: ${e.message}`)}}function Q(){t("checkHighScore called");try{const e=N();d>e?(t(`New High Score! Old: ${e}, New: ${d}`),R(d),m&&(m.textContent="üéâ New High Score! üéâ",m.style.display="block",setTimeout(()=>m.style.display="none",3e3))):t(`No new high score. Current score: ${d}, High Score: ${e}`)}catch(e){t(`Error in checkHighScore: ${e.message}`)}}function W(){t("resetHighScore called");try{confirm(`Reset ${u.toUpperCase()} High Score?`)&&(t(`Resetting high score for ${u}`),R(0),m&&(m.textContent="High Score Reset!",m.style.display="block",setTimeout(()=>m.style.display="none",2e3)))}catch(e){t(`Error in resetHighScore: ${e.message}`)}}function Z(){C&&(C.textContent=f)}function G(e=!1){t("resetGame called");try{S&&clearInterval(S),w&&clearInterval(w),d=0,k&&(k.textContent=d),q&&(q.textContent=""),i&&i.forEach(r=>r.classList.remove("mole")),z(),E=!1,v=!1,h&&(h.disabled=!1),l&&(l.disabled=!0,l.textContent="Pause"),g&&(g.disabled=!0),e||(f=K(u),t(`getInitialTime in resetGame returned: ${f}`)),Z(),B(),t(`Game reset. Difficulty: ${u}, time: ${f}`)}catch(r){t(`Error in resetGame: ${r.message}`)}}function V(){t("startGame called");try{if(v){t("Game already running, ignoring startGame");return}G(!0),v=!0,h&&(h.disabled=!0),l&&(l.disabled=!1),g&&(g.disabled=!1),t("Starting moveMole"),O(),t("Starting countDown timer"),w=setInterval(U,1e3),t("Game started successfully")}catch(e){t(`Error in startGame: ${e.message}`),console.error("Game start failed:",e)}}function ee(){t("pauseGame called");try{if(!v){t("Game not running, ignoring pauseGame");return}E?(O(),w=setInterval(U,1e3),l&&(l.textContent="Pause"),E=!1,t("Game resumed")):(clearInterval(S),clearInterval(w),l&&(l.textContent="Resume"),E=!0,t("Game paused"))}catch(e){t(`Error in pauseGame: ${e.message}`)}}function te(){t("randomSquare called");try{if(!i||i.length===0){t("Error: squares not initialized");return}i.forEach(o=>{o.classList.remove("mole")}),i.forEach(o=>o.classList.remove("selected")),b=null,c=null;const e=F(9,!0),r=i[e];r.classList.add("mole"),b=r.id,t(`Mole spawned at position ${e}`)}catch(e){t(`Error in randomSquare: ${e.message}`),console.error("Random square error:",e)}}function P(e){if(!v||E)return;const r=i[e];if(r&&r.id==b&&(d=_(d,u,f),k&&(k.textContent=d),b=null,y))try{y.currentTime=0,y.play().catch(o=>{console.log("Audio play prevented:",o)})}catch(o){console.log("Audio error:",o)}}function re(){i&&i.forEach((e,r)=>{e.addEventListener("mousedown",()=>{P(r),p(r)})})}function p(e){c!==null&&i[c]&&i[c].classList.remove("selected"),c=e,i[c]&&(i[c].classList.add("selected"),i[c].focus({preventScroll:!0}),A&&(A.textContent=`Selected Hole ${c+1}`))}function O(){t("moveMole called");try{S&&clearInterval(S);const e=X(f,u);t(`Setting mole timer with speed: ${e}`),S=setInterval(te,e)}catch(e){t(`Error in moveMole: ${e.message}`),console.error("Move mole error:",e)}}function U(){if(f--,C&&(C.textContent=f),Y(f,u)&&O(),f==0){clearInterval(w),clearInterval(S),q&&(q.textContent=`Your final score is : ${d}`);const e=document.querySelector(".stats");e&&(e.style.display="flex"),v=!1,h&&(h.disabled=!0),l&&(l.disabled=!0),g&&(g.disabled=!1),i&&i.forEach(r=>r.classList.remove("mole")),Q()}}function oe(){M&&M.forEach(e=>{e.addEventListener("click",()=>{v||(M.forEach(r=>r.classList.remove("active")),e.classList.add("active"),u=e.dataset.level,T&&(T.textContent=u.charAt(0).toUpperCase()+u.slice(1)),G(),B())})}),document.addEventListener("keydown",e=>{const r=document.activeElement.tagName;if(r==="INPUT"||r==="TEXTAREA")return;if(/^[1-9]$/.test(e.key)){const s=parseInt(e.key,10)-1;p(s),P(s),e.preventDefault();return}const o=3;c===null&&p(4);let a=Math.floor(c/o),n=c%o;switch(e.key){case"ArrowLeft":n=Math.max(0,n-1),p(a*o+n),e.preventDefault();break;case"ArrowRight":n=Math.min(o-1,n+1),p(a*o+n),e.preventDefault();break;case"ArrowUp":a=Math.max(0,a-1),p(a*o+n),e.preventDefault();break;case"ArrowDown":a=Math.min(2,a+1),p(a*o+n),e.preventDefault();break;case"Enter":case" ":P(c),e.preventDefault();break}}),h&&h.addEventListener("click",V),l&&l.addEventListener("click",ee),g&&g.addEventListener("click",G),D&&D.addEventListener("click",W)}function ne(){try{t("Initializing game..."),j(),J(),z(),G(),B(),oe(),re(),t("Game initialized successfully")}catch(e){console.error("Game initialization failed:",e),alert("Game failed to initialize. Please refresh the page.")}}document.addEventListener("DOMContentLoaded",()=>{t("DOM Content Loaded"),ne()});const L=document.getElementById("theme-toggle"),ie=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;(localStorage.getItem("theme")==="dark"||!localStorage.getItem("theme")&&ie)&&(document.body.classList.add("dark"),L&&(L.textContent="‚òÄÔ∏è"));L&&L.addEventListener("click",()=>{document.body.classList.toggle("dark");const e=document.body.classList.contains("dark");localStorage.setItem("theme",e?"dark":"light"),L.textContent=e?"‚òÄÔ∏è":"üåô"});
